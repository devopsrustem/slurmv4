---
# –¢–µ—Å—Ç–æ–≤—ã–π playbook –¥–ª—è —Ä–æ–ª–∏ common

- name: "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ–ª–∏ common"
  hosts: slurm_cluster
  become: true
  gather_facts: true
  
  pre_tasks:
    - name: "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏"
      debug:
        msg: |
          üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–æ–ª—å common –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–µ
          üéØ –£–∑–ª—ã: {{ groups['slurm_cluster'] }}
          üìä –í—Å–µ–≥–æ —É–∑–ª–æ–≤: {{ groups['slurm_cluster'] | length }}

  roles:
    - common

  post_tasks:
    - name: "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"
      debug:
        msg: |
          ‚úÖ –†–æ–ª—å common –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ {{ inventory_hostname }}
          üîß –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É MUNGE: systemctl status munge
          üìÅ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ NFS –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: df -h | grep nfs
          üë§ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è slurm: id slurm