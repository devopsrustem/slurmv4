# roles/slurm_master/tasks/main.yml
---
# =============================================================================
# SLURM MASTER NODE CONFIGURATION (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
# =============================================================================

- name: "[SLURM-MASTER] –ù–∞—á–∞–ª–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Slurm Master"
  debug:
    msg: |
      üéØ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Slurm Master —É–∑–ª–∞: {{ inventory_hostname }}
      üìç –†–æ–ª—å: {{ slurm_controller_role | default('primary') }}
      üåê IP: {{ ansible_default_ipv4.address | default('–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è...') }}

# =============================================================================
# MARIADB SETUP (—Ç–æ–ª—å–∫–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, –ø–∞–∫–µ—Ç—ã —É–∂–µ –≤ common)
# =============================================================================

- name: "[SLURM-MASTER] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MariaDB –¥–ª—è Slurm"
  include_tasks: mariadb.yml
  when: slurm_db_enabled | default(true)

# =============================================================================
# SLURM CONFIGURATION
# =============================================================================

- name: "[SLURM-MASTER] –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Slurm"
  include_tasks: config.yml

# =============================================================================
# SYSTEMD SERVICES
# =============================================================================

- name: "[SLURM-MASTER] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ systemd —Å–µ—Ä–≤–∏—Å–æ–≤"
  include_tasks: services.yml

# =============================================================================
# –§–ò–ù–ê–õ–¨–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø
# =============================================================================

- name: "[SLURM-MASTER] –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
  debug:
    msg: |
      ‚úÖ Slurm Master –Ω–∞—Å—Ç—Ä–æ–µ–Ω!
      üîß –ö–ª–∞—Å—Ç–µ—Ä: {{ slurm_cluster_name | default('hpc-cluster') }}
      üéõÔ∏è Controller: {{ inventory_hostname }}:{{ slurm_controller_port | default(6817) }}
      üíæ Database: {{ slurm_db_enabled | default(true) | ternary('–≤–∫–ª—é—á–µ–Ω–∞', '–æ—Ç–∫–ª—é—á–µ–Ω–∞') }}